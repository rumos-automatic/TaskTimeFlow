# TaskTimeFlow 開発ロードマップ

## 📊 現在の進捗状況（2025-07-01更新）

### ✅ 完了フェーズ
- **Phase 2**: コア機能開発 - **完了**
  - タスクプール（かんばんボード）
  - タイムライン機能
  - カレンダービュー
  - クロスビュードラッグ&ドロップ
  - **📅 カレンダービューからのタスク作成機能（時間選択付き）**
  - **📱 モバイル最適化（タッチイベント、UI改善）**
  - **📋 タスクコピー機能**
  - **🔄 繰り返しタスク機能（完全版）** ← タスク完了時の自動生成対応
  - **✏️ カレンダータスク編集機能**
  - **📅 日付選択・変更機能**
  - **📝 タスクメモ機能（リッチテキストエディタ）**
  - **🐛 タイムライン作成タスクの同期問題完全修正** ← NEW
- **Phase 4（一部）**: 高度な機能
  - **✅ ポモドーロタイマー機能 - 完了**
  - **✅ AI機能UI実装 - 完了**
  - **✅ ユーザー設定画面 - 完了**

### 🚧 開発中
- **Phase 3**: Google連携（準備中）
- **Phase 4**: 分析・レポート機能、AI機能実装

### 🎯 最新の修正・機能追加（v0.9.3 - 2025-07-01）
- **🐛 重要バグ修正 - タイムライン作成タスクの同期問題完全解決**
  - スマホでタイムライン作成タスクがタスクプールに表示される問題を修正
  - 根本原因：moveTaskToTimeline関数でscheduledDate/scheduledTimeがDBに保存されていなかった
  - TaskService.updateTaskによるタスクスケジュール情報の永続化実装
  - リアルタイム同期でnullに戻る問題を完全解決
  - PCとスマホで完全に一貫した動作を実現
- **🔧 開発品質向上**
  - TypeScriptビルドエラー修正（TaskService.updateTask引数修正）
  - ESLint警告修正（useCallback依存関係最適化）
  - Vercelデプロイ時のコンパイルエラー完全解決

### 🎯 前回の修正・機能追加（v0.9.2 - 2025-06-30）
- **📱 タスク編集機能の大幅改善**
  - スマホ版タイムラインでタスク所要時間編集が反映されない問題を修正
  - 数値入力フィールドの操作性を根本的に改善
  - 数字の削除・編集が自由にできるように修正
  - PC・スマホ両方で快適な入力体験を実現

### 🎯 前回の修正・機能追加（v0.9.1 - 2025-06-29）
- **📅 月単位ナビゲーション機能**
  - 前月・次月への移動ボタン実装
  - ダブルシェブロンアイコンで視覚的区別
  - 日本語ツールチップによる操作性向上

### 🎯 前回の修正・機能追加（v0.9.0 - 2025-06-29）
- **🤖 AI機能UIの実装**
  - ヘッダーバーにAIチャットアイコン追加
  - 開発中プレースホルダー画面
  - 全ビュー（モバイル/デスクトップ）対応
- **⚙️ ユーザー設定画面の実装**
  - 一般設定（プロフィール、タイムゾーン、言語）
  - APIキー設定（OpenAI、Claude、Gemini）
  - 通知設定（デスクトップ、サウンド、メール）
  - 外観設定（テーマ、アニメーション）
- **🔐 APIキー管理機能**
  - user_api_keysテーブル作成
  - 暗号化保存対応（デモ実装）
  - プロバイダー別管理

### 🎯 前回の修正・機能追加（v0.8.0 - 2025-06-29）
- **🔄 繰り返しタスク機能の完全実装**
  - タスク完了時の自動生成機能追加
  - 繰り返し属性の完全引き継ぎ実現
  - データベース保存・読み込み対応
  - 紫色アイコンで視覚的識別
- **🔗 認証エラー修正**
  - URL表示のauth_callback_failedエラー自動クリア
  - 不要な認証処理のスキップ
- **🐛 バグ修正**
  - 繰り返しタスク属性引き継ぎ問題解決
  - TypeScript型定義の不整合修正

### 🎯 前回の修正・機能追加（v0.7.0 - 2025-06-29）
- **📅 カレンダー完全体験の実現**
  - デスクトップ: タスク名クリックで編集モード
  - モバイル: 色付きドットタップで編集
  - 任意日付への作成・移動機能
  - HTML5 dateピッカーによる直感的UI
- **⚠️ 日付処理根本修正**
  - UTC時刻変換問題を完全解決
  - formatDateForDatabase/parseDateFromDatabase実装
  - 7/13→7/12のずれ問題完全修正
- **🎯 UI/UX改善**
  - 日付ナビゲーション位置固定（連続クリック誤操作防止）
  - 固定幅レイアウトによる一貫したボタン配置
  - フォーム統一デザイン改善
- **🔒 データセキュリティ強化**
  - クロスユーザーデータ汚染問題修正
  - ユーザー所有権追跡機能実装
  - ローカルデータ移行の安全性確保

### 🛠️ 過去の修正（v0.6.2以前）
- **Vercel TypeScript ビルドエラー修正**
- **タイムライン反映問題修正**
- **モバイル版プラスボタンの無限増殖バグ修正**
- **ポモドーロタイマーの休憩時間バグ修正**

### 📈 プロジェクト統計（v0.9.3時点）
- **コンポーネント数**: 32個（React TSX）← AI・設定関連コンポーネント追加
- **ライブラリファイル数**: 22個（TypeScript）
- **総TypeScriptファイル数**: 65個
- **実装済み機能数**: 16個の主要機能（AI UI、設定画面、APIキー管理追加）
- **データベーステーブル**: 7個（Supabase）← user_api_keys追加
- **ビルドサイズ**: ~298KB（圧縮後）
- **開発進捗**: Phase 2完了、Phase 4の50%完了
- **バグ修正**: 累計28個の不具合を解決（+3個）← 重要な同期問題修正

### 🎯 開発効率性（v0.9.3）
- **MVP完成度**: 98%（タイムライン同期問題完全解決）
- **カレンダー機能**: 100%（作成・編集・日付選択）
- **タスク管理**: 100%（CRUD・コピー・繰り返し・メモ完全対応）
- **UI/UX**: 99%（プラットフォーム間一貫性向上）
- **モバイル対応**: 98%（タイムライン作成タスク問題解決）
- **データ同期**: 97%（タスクスケジュール永続化完全実装）
- **自動化**: 95%（タスク完了時の自動生成対応）
- **AI準備**: 40%（UI完了、APIキー管理完了、実装待ち）
- **コード品質**: 95%（TypeScript・ESLint問題完全解決）

## 全体スケジュール（約3ヶ月）

```
Phase 1: 基盤構築（2週間）        ✅ 完了
Phase 2: コア機能開発（4週間）    ✅ 完了
Phase 3: Google連携（3週間）      🚧 開発中
Phase 4: 高度な機能（3週間）      🚧 一部完了
Phase 5: 商用化準備（2週間）      📅 計画中
```

### 🏆 現在の達成状況
- **Phase 1-2**: 100% 完了
- **Phase 3**: 0% （次の優先開発項目）
- **Phase 4**: 50% 完了（ポモドーロ、AI UI、設定画面実装済み）
- **Phase 5**: 0%
- **全体進捗**: 約53%（重要バグ修正・開発品質向上により微増）

## Phase 1: 基盤構築（2週間）

### Week 1: 環境構築とプロジェクトセットアップ
- [ ] Turborepoによるモノレポ構築
- [ ] Next.js + TypeScriptのセットアップ
- [ ] NestJS + Prismaのセットアップ
- [ ] Dockerによる開発環境構築
- [ ] CI/CD パイプラインの設定（GitHub Actions）
- [ ] ESLint、Prettier、Huskyの設定

### Week 2: 認証システムと基本UI
- [ ] Supabase Authの統合
- [ ] Google OAuth実装
- [ ] 基本的なレイアウトコンポーネント
- [ ] テーマシステムの実装（ガラスモーフィズム含む）
- [ ] Storybookの設定とコンポーネントカタログ

**成果物**: 
- ログイン可能な基本アプリケーション
- デザインシステムの基盤

## Phase 2: コア機能開発（4週間）

### Week 3-4: かんばんボード
- [x] タスクモデルの実装（Zustandストア）
- [x] かんばんボードUIの実装（タスクプール）
- [x] タスクカードコンポーネント
- [x] ドラッグ&ドロップ機能（@dnd-kit）
- [x] タスクCRUD操作
- [x] フィルタリング（カテゴリタブ）

### Week 5-6: タイムライン機能とクロスビュー連携
- [x] カレンダービューの実装
- [x] タイムラインUIコンポーネント
- [x] タスクの時間割り当て機能
- [x] ドラッグによる時間変更
- [x] 日/週/月ビューの切り替え（カレンダー/タイムライン）
- [x] **クロスビュードラッグ&ドロップ実装（完了）**
- [x] かんばん⇔タイムライン間の状態同期

**成果物**: 
- 動作するかんばんボード
- 基本的なタイムライン機能
- クロスビュードラッグ&ドロップ機能

## Phase 3: Google連携（3週間）

### Week 7: Google API統合準備
- [ ] Google Cloud Projectの設定
- [ ] OAuth同意画面の設定
- [ ] API認証フローの実装
- [ ] トークン管理システム

### Week 8: Googleカレンダー連携
- [ ] Calendar API統合
- [ ] イベントの双方向同期
- [ ] 同期IDによる重複防止
- [ ] 競合解決ロジック
- [ ] Webhook設定（Push通知）

### Week 9: Google Todo連携
- [ ] Tasks API統合
- [ ] タスクリストの同期
- [ ] タスクの双方向同期
- [ ] 同期状態のUI表示

**成果物**: 
- Google連携が動作するアプリケーション
- リアルタイム同期機能

## Phase 4: 高度な機能（3週間）

### Week 10: ポモドーロタイマー & AI機能UI
- [x] タイマーコンポーネントの実装
- [x] 作業セッション管理（25分作業/5分休憩）
- [x] 通知機能（ブラウザ通知）
- [x] タスクとの連携
- [x] 統計情報の記録（完了ポモドーロ数）
- [x] **AI機能UIの実装（チャットアイコン、ダイアログ）**
- [x] **ユーザー設定画面の実装**
- [x] **APIキー管理機能の実装**

### Week 11: AI機能実装 & 分析・レポート機能
- [ ] AI機能の実装
  - [ ] チャット形式でのタスク作成
  - [ ] スクリーンショット解析
  - [ ] 自然言語処理によるタスク分解
- [ ] Edge APIでのLLM連携
- [ ] 完了タスク一覧画面の実装
- [ ] 日別・週別・月別の統計表示
- [ ] データビジュアライゼーション（Chart.js/Recharts）
- [ ] 生産性指標の計算とレポート
- [ ] タスクログ機能の実装
- [ ] エクスポート機能（CSV/PDF）

### Week 12: パフォーマンス最適化
- [ ] 仮想スクロールの実装
- [ ] 画像・アセットの最適化
- [ ] Service Workerによるオフライン対応
- [ ] Lighthouseスコアの改善

**成果物**: 
- フル機能のアプリケーション
- 分析・レポート機能搭載
- パフォーマンスが最適化されたUX

## Phase 5: 商用化準備（2週間）

### Week 13: 決済システムとプラン管理
- [ ] Stripe統合
- [ ] サブスクリプションプラン実装
- [ ] 使用制限の実装（無料/有料）
- [ ] 決済フローのテスト

### Week 14: リリース準備
- [ ] プロダクション環境構築
- [ ] セキュリティ監査
- [ ] ドキュメント整備
- [ ] マーケティングサイト準備
- [ ] 利用規約・プライバシーポリシー

**成果物**: 
- リリース可能な製品
- 運用ドキュメント

## 各フェーズの注意点

### Phase 1
- **リスク**: 技術選定の誤り
- **対策**: プロトタイプによる早期検証

### Phase 2
- **リスク**: UXの複雑化
- **対策**: ユーザビリティテストの実施

### Phase 3
- **リスク**: API制限・レート制限
- **対策**: キューシステムの実装、エラーハンドリング

### Phase 4
- **リスク**: パフォーマンス劣化
- **対策**: 継続的なパフォーマンス測定

### Phase 5
- **リスク**: セキュリティ脆弱性
- **対策**: セキュリティ監査、ペネトレーションテスト

## マイルストーン

1. **M1（Week 2）**: ログイン可能なアプリ
2. **M2（Week 6）**: かんばん＋タイムラインMVP
3. **M3（Week 9）**: Google連携完了
4. **M4（Week 12）**: フル機能版完成
5. **M5（Week 14）**: 商用版リリース

## 開発チーム構成（想定）

### 1人開発の場合
- 上記スケジュールで進行
- 各フェーズで外部レビューを依頼

### チーム開発の場合
- **フロントエンド**: 1-2名
- **バックエンド**: 1名
- **デザイン/UX**: 1名（パートタイム）

## 次のステップ

1. **技術検証**: 選定した技術スタックのPOC作成
2. **デザイン詳細**: FigmaでのUIモックアップ作成
3. **開発環境構築**: Phase 1の開始

---

このロードマップについて、調整したい部分や懸念事項があれば教えてください！